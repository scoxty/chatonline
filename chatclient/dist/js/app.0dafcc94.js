(function(){"use strict";var e={471:function(e,t,s){var a=s(6848),i=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},o=[],r=s(1656),n={},l=(0,r.A)(n,i,o,!1,null,null,null),c=l.exports,d=s(6178),m=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticStyle:{color:"#5050bb","font-weight":"bold","font-size":"20px"}},[e._v(" 欢迎您 "+e._s(e.user.name)+"，这里是在线聊天系统 ！ ")]),t("div",{staticStyle:{display:"flex","margin-top":"20px"}},[t("div",{staticStyle:{flex:"1"}},[t("div",{staticStyle:{"margin-bottom":"15px","margin-top":"30px","font-weight":"bold","font-size":"18px",color:"#344675"}},[e._v(" 系统公告 ")]),t("el-collapse",{attrs:{accordion:""},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},e._l(e.data,(function(s){return t("el-collapse-item",{attrs:{title:s.name,name:s.id}},[t("template",{slot:"title"},[t("i",{staticClass:"header-icon el-icon-info"},[e._v(" "+e._s(s.name)+" ")])]),t("div",{staticStyle:{padding:"0 20px"}},[e._v(e._s(s.content))])],2)})),1)],1),t("div",{staticStyle:{flex:"1"}})])])},u=[],p=s(4373);const h=p.A.create({baseURL:"http://localhost:8080/api",timeout:5e3});h.interceptors.request.use((e=>{e.headers["Content-Type"]="application/json;charset=utf-8";const t=localStorage.getItem("user");return t&&(e.headers["token"]=JSON.parse(t).token),e}),(e=>Promise.reject(e))),h.interceptors.response.use((e=>{let t=e.data;return"string"===typeof t&&(t=t?JSON.parse(t):t),t}),(e=>(console.log("err"+e),Promise.reject(e))));var g=h,f={name:"HomeView",data(){return{activeName:"1",data:[],user:localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")):{}}},mounted(){this.findNotice()},methods:{findNotice(){g.get("/notice").then((e=>{"0"===e.code?(this.data=e.data,this.activeName=e.data[0].id):this.$message.error(e.msg)}))}}},v=f,y=(0,r.A)(v,m,u,!1,null,"07b3eae4",null),b=y.exports,S=function(){var e=this,t=e._self._c;return t("div",{staticClass:"login-container"},[t("div",{staticStyle:{width:"400px",height:"400px",margin:"150px auto","background-color":"rgba(158, 185, 232, 0.5)","border-radius":"10px"}},[t("div",{staticStyle:{width:"100%",height:"100px","font-size":"30px","line-height":"100px","text-align":"center",color:"#32327d"}},[e._v(" 欢迎登录 在线聊天系统 ")]),t("div",{staticStyle:{"margin-top":"25px","text-align":"center",height:"320px"}},[t("el-form",{attrs:{model:e.admin}},[t("el-form-item",[t("el-input",{staticStyle:{width:"80%"},attrs:{"prefix-icon":"el-icon-user",placeholder:"请输入用户名"},model:{value:e.admin.name,callback:function(t){e.$set(e.admin,"name",t)},expression:"admin.name"}})],1),t("el-form-item",[t("el-input",{staticStyle:{width:"80%"},attrs:{"show-password":"","prefix-icon":"el-icon-lock",placeholder:"请输入密码"},model:{value:e.admin.password,callback:function(t){e.$set(e.admin,"password",t)},expression:"admin.password"}})],1),t("el-form-item",[t("div",{staticStyle:{display:"flex","justify-content":"center"}},[t("el-input",{staticStyle:{width:"42%","margin-right":"10px"},attrs:{"prefix-icon":"el-icon-user",placeholder:"请输入验证码"},model:{value:e.admin.verCode,callback:function(t){e.$set(e.admin,"verCode",t)},expression:"admin.verCode"}}),t("img",{attrs:{src:e.captchaUrl,width:"140px",height:"33px"},on:{click:function(t){return e.clickImg()}}})],1)]),t("el-form-item",[t("el-button",{staticStyle:{width:"80%","margin-top":"10px"},attrs:{type:"primary"},on:{click:function(t){return e.login()}}},[e._v("登 录")])],1),t("div",{staticStyle:{"text-align":"center"}},[t("span",{staticStyle:{color:"#151617","font-size":"15px"}},[e._v("未有账号？")]),t("a",{staticStyle:{"text-decoration":"none","font-size":"15px"},attrs:{href:"javascript:void(0)"},on:{click:e.navRegister}},[e._v("点击注册")])])],1)],1)])])},x=[],w=(s(4114),{name:"Login",data(){return{admin:{},captchaUrl:"",key:""}},created(){this.key=Math.random(),this.captchaUrl="http://localhost:8080/api/captcha?key="+this.key},methods:{login(){g.post("/user/login?key="+this.key,this.admin).then((e=>{"0"===e.code?(this.$message.success("登录成功"),localStorage.setItem("user",JSON.stringify(e.data)),this.$router.push("/")):(this.$message.error(e.msg),this.key=Math.random(),this.captchaUrl="http://localhost:8080/api/captcha?key="+this.key)}))},clickImg(){this.key=Math.random(),this.captchaUrl="http://localhost:8080/api/captcha?key="+this.key},navRegister(){this.$router.push("/register")}}}),A=w,k=(0,r.A)(A,S,x,!1,null,"5f1cc432",null),C=k.exports,B=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticStyle:{"margin-bottom":"15px"}},[t("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入姓名"},model:{value:e.params.name,callback:function(t){e.$set(e.params,"name",t)},expression:"params.name"}}),t("el-input",{staticStyle:{width:"200px","margin-left":"5px"},attrs:{placeholder:"请输入电话"},model:{value:e.params.phone,callback:function(t){e.$set(e.params,"phone",t)},expression:"params.phone"}}),t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"warning"},on:{click:function(t){return e.findBySearch()}}},[e._v("查询")]),t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"warning"},on:{click:function(t){return e.reset()}}},[e._v("清空")]),"ADMIN"===e.user.role?t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:function(t){return e.add()}}},[e._v("新增")]):e._e()],1),t("div",[t("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:e.tableData}},[t("el-table-column",{attrs:{align:"center",label:"头像"},scopedSlots:e._u([{key:"default",fn:function(e){return[t("el-image",{staticStyle:{width:"50px",height:"50px","border-radius":"50%"},attrs:{src:e.row.avatar,"preview-src-list":[e.row.avatar]}})]}}])}),t("el-table-column",{attrs:{align:"center",prop:"name",label:"姓名"}}),t("el-table-column",{attrs:{align:"center",prop:"sex",label:"性别"}}),t("el-table-column",{attrs:{align:"center",prop:"age",label:"年龄"}}),t("el-table-column",{attrs:{align:"center",prop:"phone",label:"电话"}}),t("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-button",{attrs:{type:"success",plain:""},on:{click:function(t){return e.handleTianjia(s.row)}}},[e._v("添加")]),"ADMIN"===e.user.role?[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.edit(s.row)}}},[e._v("编辑")]),t("el-popconfirm",{attrs:{title:"确定删除吗？"},on:{confirm:function(t){return e.del(s.row.id)}}},[t("el-button",{staticStyle:{"margin-left":"5px"},attrs:{slot:"reference",type:"danger"},slot:"reference"},[e._v("删除")])],1)]:e._e()]}}])})],1)],1),t("div",{staticStyle:{"margin-top":"10px"}},[t("el-pagination",{attrs:{"current-page":e.params.pageNum,"page-sizes":[5,10,15,20],"page-size":e.params.pageSize,layout:"total, sizes, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("div",[t("el-dialog",{attrs:{title:"请填写信息",visible:e.dialogFormVisible,width:"30%"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[t("el-form",{attrs:{model:e.form}},[t("el-form-item",{attrs:{label:"姓名","label-width":"15%"}},[t("el-input",{staticStyle:{width:"90%"},attrs:{autocomplete:"off"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),t("el-form-item",{attrs:{label:"性别","label-width":"15%"}},[t("el-radio",{attrs:{label:"男"},model:{value:e.form.sex,callback:function(t){e.$set(e.form,"sex",t)},expression:"form.sex"}},[e._v("男")]),t("el-radio",{attrs:{label:"女"},model:{value:e.form.sex,callback:function(t){e.$set(e.form,"sex",t)},expression:"form.sex"}},[e._v("女")])],1),t("el-form-item",{attrs:{label:"年龄","label-width":"15%"}},[t("el-input",{staticStyle:{width:"90%"},attrs:{autocomplete:"off"},model:{value:e.form.age,callback:function(t){e.$set(e.form,"age",t)},expression:"form.age"}})],1),t("el-form-item",{attrs:{label:"电话","label-width":"15%"}},[t("el-input",{staticStyle:{width:"90%"},attrs:{autocomplete:"off"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),t("el-form-item",{attrs:{label:"分组","label-width":"15%"}},[t("el-select",{staticStyle:{width:"90%"},attrs:{placeholder:"请选择"},model:{value:e.form.role,callback:function(t){e.$set(e.form,"role",t)},expression:"form.role"}},[t("el-option",{attrs:{label:"管理员",value:"ADMIN"}}),t("el-option",{attrs:{label:"用户",value:"USER"}})],1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submit()}}},[e._v("确 定")])],1)],1)],1)])},N=[],I={data(){return{params:{name:"",phone:"",pageNum:1,pageSize:5},user:localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")):{},tableData:[],total:0,dialogFormVisible:!1,form:{}}},created(){this.findBySearch()},methods:{handleTianjia(e){this.$prompt("请输入内容","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((({value:t})=>{let s={nr:t,hyUserId:e.id};g.post("/hy/add",s).then((e=>{"0"===e.code?this.$message.success("提交成功!"):this.$message.error(e.msg)}))})).catch((()=>{}))},findBySearch(){g.get("/user/search",{params:this.params}).then((e=>{"0"===e.code?(this.tableData=e.data.list,this.total=e.data.total):this.$message({message:e.msg,type:"success"})}))},add(){this.form={},this.dialogFormVisible=!0},edit(e){this.form=e,this.dialogFormVisible=!0},reset(){this.params={pageNum:1,pageSize:5,name:"",phone:""},this.findBySearch()},handleSizeChange(e){this.params.pageSize=e,this.findBySearch()},handleCurrentChange(e){this.params.pageNum=e,this.findBySearch()},submit(){g.post("/user",this.form).then((e=>{"0"===e.code?(this.$message({message:"操作成功",type:"success"}),this.dialogFormVisible=!1,this.findBySearch()):this.$message({message:e.msg,type:"error"})}))},del(e){g.delete("/user/"+e).then((e=>{"0"===e.code?(this.$message({message:"删除成功",type:"success"}),this.findBySearch()):this.$message({message:e.msg,type:"success"})}))}}},z=I,E=(0,r.A)(z,B,N,!1,null,null,null),Q=E.exports,U=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"header"},[e._m(0),e._m(1),t("div",{staticClass:"header-right"},[t("div",[t("el-dropdown",[t("div",{staticClass:"header-dropdown"},[t("img",{attrs:{src:e.user.avatar,alt:""}}),t("div",{staticStyle:{"margin-left":"10px"}},[t("span",{staticStyle:{color:"white"}},[e._v(e._s(e.user.name))]),t("i",{staticClass:"el-icon-arrow-down",staticStyle:{"margin-left":"5px"}})])]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",[t("div",{on:{click:function(t){return e.$router.push("/person")}}},[e._v("个人中心")])]),t("el-dropdown-item",[t("div",{on:{click:function(t){return e.$router.push("/password")}}},[e._v("修改密码")])]),t("el-dropdown-item",[t("div",{staticStyle:{"text-decoration":"none"},on:{click:e.logout}},[e._v("退出")])])],1)],1)],1)])]),t("el-container",[t("el-aside",{staticStyle:{overflow:"hidden","min-height":"100vh","background-color":"#32325d",width:"250px"}},[t("el-menu",{attrs:{"default-active":e.$route.path,"default-openeds":"[1,2,3,4]",router:"","background-color":"#32325d","text-color":"#ECF0F1","active-text-color":"#85C1E9"}},[t("el-submenu",{attrs:{index:"1"}},[t("template",{slot:"title"},[t("i",{staticClass:"el-icon-s-home"}),t("span",[e._v("系统首页")])]),t("el-menu-item",{attrs:{index:"/"}},[t("i",{staticClass:"el-icon-position"}),t("span",{attrs:{slot:"title"},slot:"title"},[e._v("系统首页")])])],2),t("el-submenu",{attrs:{index:"2"}},[t("template",{slot:"title"},[t("i",{staticClass:"el-icon-s-custom"}),t("span",[e._v("聊天室")])]),t("el-menu-item-group",[t("el-menu-item",{attrs:{index:"/imSingle"}},[t("i",{staticClass:"el-icon-chat-round"}),t("span",{attrs:{slot:"title"},slot:"title"},[e._v("单人聊天")])]),t("el-menu-item",{attrs:{index:"/imGroup"}},[t("i",{staticClass:"el-icon-chat-dot-round"}),t("span",{attrs:{slot:"title"},slot:"title"},[e._v("群组聊天")])])],1)],2),"ADMIN"===e.user.role?t("el-submenu",{attrs:{index:"3"}},[t("template",{slot:"title"},[t("i",{staticClass:"el-icon-s-tools"}),t("span",[e._v("系统管理")])]),t("el-menu-item-group",[t("el-menu-item",{attrs:{index:"/user"}},[t("i",{staticClass:"el-icon-user"}),t("span",{attrs:{slot:"title"},slot:"title"},[e._v("用户管理")])]),t("el-menu-item",{attrs:{index:"/notice"}},[t("i",{staticClass:"el-icon-bell"}),t("span",{attrs:{slot:"title"},slot:"title"},[e._v("系统公告")])]),t("el-menu-item",{attrs:{index:"4"}},[t("i",{staticClass:"el-icon-switch-button"}),t("span",{on:{click:e.logout}},[e._v("退出登录")])])],1)],2):e._e(),t("el-submenu",{attrs:{index:"4"}},[t("template",{slot:"title"},[t("i",{staticClass:"el-icon-s-tools"}),t("span",[e._v("好友管理")])]),t("el-menu-item-group",[t("el-menu-item",{attrs:{index:"/user"}},[t("i",{staticClass:"el-icon-user"}),t("span",{attrs:{slot:"title"},slot:"title"},[e._v("用户列表")])]),t("el-menu-item",{attrs:{index:"/hyyz"}},[t("i",{staticClass:"el-icon-user"}),t("span",{attrs:{slot:"title"},slot:"title"},[e._v("申请列表")])]),t("el-menu-item",{attrs:{index:"/hy"}},[t("i",{staticClass:"el-icon-user"}),t("span",{attrs:{slot:"title"},slot:"title"},[e._v("好友列表")])])],1)],2)],1)],1),t("el-main",[t("router-view")],1)],1)],1)},O=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"header-left"},[t("img",{attrs:{src:s(3153),alt:""}}),t("div",{staticClass:"title"},[e._v("在线聊天系统")])])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"header-center"},[t("div",{staticClass:"header-nav"})])}],M={name:"Layout",data(){return{user:localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")):{}}},mounted(){this.$bus.$on("updateAvatar",(e=>{this.user=e,localStorage.setItem("user",JSON.stringify(this.user))}))},methods:{logout(){localStorage.removeItem("user"),this.$router.push("/login")}}},D=M,R=(0,r.A)(D,U,O,!1,null,"3b503ef4",null),L=R.exports,_=function(){var e=this,t=e._self._c;return t("div",{staticClass:"login-container"},[t("div",{staticStyle:{width:"450px",height:"400px",margin:"150px auto","background-color":"rgba(165,190,234,0.5)","border-radius":"10px"}},[t("div",{staticStyle:{width:"100%",height:"100px","font-size":"30px","line-height":"100px","text-align":"center",color:"#5050bb"}},[e._v(" 欢迎注册")]),t("div",{staticStyle:{"margin-top":"25px","text-align":"center",height:"320px"}},[t("el-form",{attrs:{model:e.admin}},[t("el-form-item",[t("el-input",{staticStyle:{width:"80%"},attrs:{"prefix-icon":"el-icon-user",placeholder:"请输入用户名"},model:{value:e.admin.name,callback:function(t){e.$set(e.admin,"name",t)},expression:"admin.name"}})],1),t("el-form-item",[t("el-input",{staticStyle:{width:"80%"},attrs:{"show-password":"","prefix-icon":"el-icon-lock",placeholder:"请输入密码"},model:{value:e.admin.password,callback:function(t){e.$set(e.admin,"password",t)},expression:"admin.password"}})],1),t("el-form-item",[t("el-button",{staticStyle:{width:"80%","margin-top":"10px"},attrs:{type:"primary"},on:{click:function(t){return e.register()}}},[e._v("注册")])],1),t("div",{staticStyle:{"text-align":"center"}},[t("span",{staticStyle:{"font-size":"15px"}},[e._v("已有账号")]),e._v("？"),t("a",{staticStyle:{"text-decoration":"none","font-size":"15px"},attrs:{href:"javascript:void(0)"},on:{click:e.navLogin}},[e._v("点击登录")])])],1)],1)])])},F=[],T={name:"Register",data(){return{admin:{}}},created(){},methods:{register(){g.post("/user/register",this.admin).then((e=>{"0"===e.code?(this.$message({message:"注册成功",type:"success"}),this.$router.push("/login")):this.$message({message:e.msg,type:"error"})}))},navLogin(){this.$router.push("/login")}}},P=T,H=(0,r.A)(P,_,F,!1,null,"38868b64",null),G=H.exports,Z=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"main-body-content"},[t("div",{staticStyle:{display:"flex","align-items":"flex-start",height:"80vh"}},[t("div",{staticStyle:{width:"200px",border:"1px solid #ddd","border-radius":"10px",height:"100%"}},[t("div",{staticStyle:{padding:"10px","border-bottom":"1px solid #ddd",color:"#000","background-color":"#eee","border-radius":"10px 10px 0 0"}},[e._v(" 好友 ")]),t("div",{staticClass:"user-list-box"},e._l(e.users.admin,(function(s){return t("div",{key:s.id,staticClass:"user-list-item",on:{click:function(t){return e.selectToUser(s)}}},[t("img",{staticStyle:{width:"30px",height:"30px","border-radius":"50%"},attrs:{src:s.userAvatar}}),t("span",{staticStyle:{flex:"1","margin-left":"10px"},style:{color:s.role+"_"+s.userName===e.toUser?"#3a8ee6":""}},[e._v(e._s(s.userName)+" ")]),e.unRead?.[s.role+"_"+s.userName]?t("div",{staticClass:"user-list-item-badge"},[e._v(" "+e._s(e.unRead?.[s.role+"_"+s.userName])+" ")]):e._e()])})),0)]),t("div",{staticStyle:{flex:"1",border:"1px solid #ddd","border-radius":"10px","background-color":"#f1f1f1",margin:"0 10px",height:"100%",display:"flex","flex-direction":"column"}},[t("div",{staticStyle:{padding:"20px 0","text-align":"center","border-bottom":"1px solid #ddd",color:"#000","background-color":"#eee",height:"60px","border-radius":"10px 10px 0 0"}},[e._v(" "+e._s(e.toUser?.substring(e.toUser.indexOf("_")+1))+" ")]),t("div",{staticClass:"im-message-box"},e._l(e.messages,(function(s){return t("div",{key:s.id},[s.fromuser===e.fromUser?t("div",{staticStyle:{display:"flex","flex-direction":"row-reverse","align-items":"flex-start"}},[t("img",{staticStyle:{width:"40px",height:"40px","border-radius":"50%","margin-left":"10px"},attrs:{src:s.fromavatar,alt:""}}),"text"===s.type?t("div",{staticClass:"im-message im-message-right",domProps:{innerHTML:e._s(s.content)}}):e._e(),"img"===s.type?t("div",{staticClass:"im-message",staticStyle:{padding:"0"}},[t("el-image",{staticStyle:{width:"100px"},attrs:{src:s.content,alt:"","preview-src-list":[s.content]},on:{load:e.scrollToBottom}})],1):e._e(),"video"===s.type?t("div",{staticClass:"im-message"},[t("video",{staticStyle:{width:"100%"},attrs:{controls:"",src:s.content},on:{loadeddata:e.scrollToBottom}})]):e._e(),"file"===s.type?t("div",{staticClass:"im-message im-message-download",on:{click:function(t){return e.download(s.content)}}},[t("div",[t("i",{staticClass:"el-icon-folder-opened"}),t("span",[e._v(e._s(s.content.substring(s.content.indexOf("-")+1)))])])]):e._e(),"audio"===s.type?t("div",{staticClass:"im-message",staticStyle:{padding:"0"}},[t("audio",{attrs:{controls:"",src:s.content}})]):e._e()]):t("div",{staticStyle:{display:"flex","align-items":"flex-start"}},[t("img",{staticStyle:{width:"40px",height:"40px","border-radius":"50%","margin-right":"10px"},attrs:{src:s.fromavatar,alt:""}}),t("div",{staticStyle:{width:"100%"}},[t("div",{staticStyle:{color:"#888","font-size":"12px",width:"50%"}},[e._v(" "+e._s(s.fromuser?.substring(s.fromuser.indexOf("_")+1))+" ")]),"text"===s.type?t("div",{staticClass:"im-message im-message-left",domProps:{innerHTML:e._s(s.content)}}):e._e(),"img"===s.type?t("div",{staticClass:"im-message",staticStyle:{padding:"0"}},[t("el-image",{staticStyle:{width:"100px"},attrs:{src:s.content,alt:"","preview-src-list":[s.content]},on:{load:e.scrollToBottom}})],1):e._e(),"video"===s.type?t("div",{staticClass:"im-message"},[t("video",{staticStyle:{width:"100%"},attrs:{controls:"",src:s.content},on:{loadeddata:e.scrollToBottom}})]):e._e(),"file"===s.type?t("div",{staticClass:"im-message im-message-download",on:{click:function(t){return e.download(s.content)}}},[t("div",[t("i",{staticClass:"el-icon-folder-opened"}),t("span",[e._v(e._s(s.content.substring(s.content.indexOf("-")+1)))])])]):e._e(),"audio"===s.type?t("div",{staticClass:"im-message",staticStyle:{padding:"0"}},[t("audio",{attrs:{controls:"",src:s.content}})]):e._e()])])])})),0),t("div",{staticStyle:{padding:"10px 5px","border-top":"1px solid #ddd",display:"flex","align-items":"center",width:"100%"}},[t("el-popover",{attrs:{placement:"top",width:"300",trigger:"click"}},[t("div",{staticClass:"emoji-box"},e._l(e.emojis,(function(s,a){return t("span",{key:a,staticStyle:{"margin-right":"5px","font-size":"20px",cursor:"pointer"},domProps:{innerHTML:e._s(s)},on:{click:function(t){return e.clickEmoji(s)}}})})),0),t("i",{staticClass:"fa fa-smile-o",staticStyle:{"font-size":"22px",color:"#666"},attrs:{slot:"reference"},slot:"reference"})]),t("div",{staticStyle:{"margin-left":"5px"}},[t("el-upload",{attrs:{action:"http://localhost:8080/api/files/upload","show-file-list":!1,"on-success":e.handleFile}},[t("i",{staticClass:"fa fa-folder-open-o",staticStyle:{"font-size":"20px",color:"#666"}})])],1),t("div",{staticStyle:{"margin-left":"5px"}},[t("i",{staticClass:"fa fa-microphone",staticStyle:{"font-size":"22px",color:"#666",cursor:"pointer"},on:{click:e.showRecord}})]),t("div",{staticStyle:{flex:"1","background-color":"#fff",margin:"0 5px",padding:"10px",border:"1px solid #ddd","border-radius":"2px",outline:"none","font-size":"14px"},attrs:{id:"im-content",contenteditable:""}}),t("el-button",{staticStyle:{border:"none"},attrs:{type:"primary"},on:{click:e.don}},[e._v("下载聊天记录 ")]),t("el-button",{staticStyle:{border:"none"},attrs:{type:"primary"},on:{click:e.send}},[e._v("发送 ")])],1)])])]),"idle"!==e.recordingStatus?t("div",{staticClass:"recording-overlay"},[t("div",{staticClass:"recording-box",staticStyle:{"margin-left":"30%"}},["ready"===e.recordingStatus?t("div",[t("i",{staticClass:"fa fa-microphone",staticStyle:{"font-size":"100px",color:"#0e81de",cursor:"pointer"}}),t("p",[e._v("按住空格键开始说话，按Esc键或点击"),t("a",{staticClass:"cancel-link",on:{click:e.cancelRecording}},[e._v("退出")])])]):e._e(),"recording"===e.recordingStatus?t("div",[t("p",[e._v(e._s(e.recordingTime.toFixed(1))+"s")]),t("div",{staticClass:"microphone-animation"},e._l(10,(function(s){return t("div",{key:s,staticClass:"wave",style:{height:e.getWaveHeight()+"px"}})})),0),t("p",[e._v("松手发送，按Esc键或点击"),t("a",{staticClass:"cancel-link",on:{click:e.cancelRecording}},[e._v("取消发送")])])]):e._e()])]):e._e()])},V=[];s(6573),s(8100),s(7936),s(7467),s(4732),s(9577),s(4603),s(7566),s(8721);const J="😀,😁,😂,😃,😄,😅,😆,😉,😊,😋,😎,😍,😘,😗,😙,😚,😇,😐,😑,😶,😏,😣,😥,😮,😯,😪,😫,😴,😌,😛,😜,😝,😒,😓,😔,😕,😲,😷,😖,😞,😟,😤,😢,😭,😦,😧,😨,😬,😰,😱,😳,😵,😡,😠,💘,❤,💓,💔,💕,💖,💗,💙,💚,💛,💜,💝,💞,💟,❣,💪,👈,👉,☝,👆,👇,✌,✋,👌,👍,👎,✊,👊,👋,👏,👐,✍,🍇,🍈,🍉,🍊,🍋,🍌,🍍,🍎,🍏,🍐,🍑,🍒,🍓,🍅,🍆,🌽,🍄,🌰,🍞,🍖,🍗,🍔,🍟,🍕,🍳,🍲,🍱,🍘,🍙,🍚,🍛,🍜,🍝,🍠,🍢,🍣,🍤,🍥,🍡,🍦,🍧,🍨,🍩,🍪,🎂,🍰,🍫,🍬,🍭,🍮,🍯,🍼,☕,🍵,🍶,🍷,🍸,🍹,🍺,🍻,🍴,🌹,🍀,🍎,💰,📱,🌙,🍁,🍂,🍃,🌷,💎,🔪,🔫,🏀,⚽,⚡,👄,👍,🔥,🙈,🙉,🙊,🐵,🐒,🐶,🐕,🐩,🐺,🐱,😺,😸,😹,😻,😼,😽,🙀,😿,😾,🐈,🐯,🐅,🐆,🐴,🐎,🐮,🐂,🐃,🐄,🐷,🐖,🐗,🐽,🐏,🐑,🐐,🐪,🐫,🐘,🐭,🐁,🐀,🐹,🐰,🐇,🐻,🐨,🐼,🐾,🐔,🐓,🐣,🐤,🐥,🐦,🐧,🐸,🐊,🐢,🐍,🐲,🐉,🐳,🐋,🐬,🐟,🐠,🐡,🐙,🐚,🐌,🐛,🐜,🐝,🐞,🦋,😈,👿,👹,👺,💀,☠,👻,👽,👾,💣";var j=J;let q,K,X,Y,W,$,ee=[];var te={data(){return{user:{},permission:[],emojis:[],messages:[],users:{},fromUser:"",toUser:"",toAvatar:"",unRead:{},id:"",recordingStatus:"idle",recordingTime:0,recordingInterval:null,audioLevels:[]}},mounted(){this.emojis=j.split(","),this.user=JSON.parse(localStorage.getItem("user")||"{}"),this.fromUser=this.user.role+"_"+this.user.name,q=new WebSocket("ws://localhost:8080/imserverSingle"),q.onopen=()=>{console.log("websocket open")},q.onclose=()=>{console.log("websocket close")},q.onmessage=e=>{if(e.data){let t=JSON.parse(e.data);(t.content&&t.fromuser===this.fromUser&&t.touser===this.toUser||t.touser===this.fromUser&&t.fromuser===this.toUser)&&(this.messages.push(t),this.scrollToBottom()),this.toUser===t.fromuser?this.setUnReadNums():this.loadUnReadNums()}},this.load(),g.get("/hy/list",{params:{pageNum:1,pageSize:1e3}}).then((e=>{e.data&&e.data.list?this.$set(this.users,"admin",e.data.list):console.error("Failed to load user list")})),window.addEventListener("keydown",this.handleKeyDown),window.addEventListener("keyup",this.handleKeyUp)},beforeDestroy(){q&&q.close(),window.removeEventListener("keydown",this.handleKeyDown),window.removeEventListener("keyup",this.handleKeyUp)},methods:{load(){g.get("/imsingle?fromUser="+this.fromUser+"&toUser="+this.toUser).then((e=>{"0"===e.code?(console.log(e),this.messages=e.data,this.scrollToBottom()):this.$notify.error(e.msg),this.loadUnReadNums()}))},setUnReadNums(){g.get("/imsingle?fromUser="+this.fromUser+"&toUser="+this.toUser).then((e=>{this.loadUnReadNums()}))},loadUnReadNums(){g.get("/imsingle/unReadNums?toUsername="+this.fromUser).then((e=>{this.unRead=e.data}))},send(){if(this.toUser){if(q){let e=this.getMessage("text");q.send(JSON.stringify(e))}document.getElementById("im-content").innerHTML=""}else this.$notify.error("请选择聊天用户")},selectToUser(e){this.toUser=e.role+"_"+e.userName,this.toAvatar=e.userAvatar,this.load()},download(e){window.open(e)},getMessage(e){let t=document.getElementById("im-content");const s=t.innerHTML;if(s||"text"!==e)return{fromuser:this.fromUser,fromavatar:this.user.avatar,touser:this.toUser,toavatar:this.toAvatar,content:s,type:e};this.$notify.error("请输入聊天内容")},handleFile(e){if(q){let t=this.getMessage("img");t.content=e.data,console.log(t.content);let s=e.data.substring(e.data.lastIndexOf(".")+1);["png","jpg","jpeg","gif","bmp","tiff","svg","webp"].includes(s)?t.type="img":["mp4","avi","mkv","mov","wmv","flv"].includes(s)?t.type="video":t.type="file",q.send(JSON.stringify(t))}},clickEmoji(e){document.getElementById("im-content").innerHTML+=e},scrollToBottom(){this.$nextTick((()=>{let e=document.getElementsByClassName("im-message-box")[0];e.scrollTop=e.scrollHeight,console.log("触发滚动")}))},don(){this.toUser?(0,p.A)({url:"http://localhost:8080/api/imsingle/don?fromUser="+this.fromUser+"&toUser="+this.toUser,method:"GET",responseType:"blob",headers:{token:this.user.token}}).then((e=>{const t=new Blob([e.data],{type:"application/octet-stream"}),s=document.createElement("a");s.href=URL.createObjectURL(t),s.download="聊天记录.xls",s.click()})).catch((e=>{console.error("下载文件时发生错误:",e)})):this.$notify.error("请选择聊天用户")},showRecord(){this.toUser?this.recordingStatus="ready":this.$notify.error("请选择聊天用户")},getWaveHeight(){return 20*Math.random()+5},cancelRecording(){this.recordingStatus="idle",clearInterval(this.recordingInterval),this.recordingInterval=null,X&&"closed"!==X.state&&X.close(),this.audioLevels=[]},startRecording(){this.recordingStatus="recording",this.recordingTime=0,ee=[],navigator.mediaDevices.getUserMedia({audio:!0}).then((e=>{K=new MediaRecorder(e),K.start(),K.ondataavailable=e=>ee.push(e.data),X=new AudioContext,Y=X.createAnalyser(),W=X.createMediaStreamSource(e),$=X.createScriptProcessor(2048,1,1),Y.smoothingTimeConstant=.3,Y.fftSize=1024,W.connect(Y),Y.connect($),$.connect(X.destination),$.onaudioprocess=()=>{const e=new Uint8Array(Y.frequencyBinCount);Y.getByteFrequencyData(e);const t=e.reduce(((e,t)=>e+t))/e.length;this.audioLevels=Array.from({length:10},(()=>t/2))},this.recordingInterval=setInterval((()=>{this.recordingTime+=.1}),100)}))},stopRecording(){if("recording"===this.recordingStatus){if(K.stop(),clearInterval(this.recordingInterval),this.recordingInterval=null,X&&"closed"!==X.state&&X.close(),this.audioLevels=[],this.recordingTime<1)return setTimeout((()=>this.cancelRecording()),1e3),void this.$notify.error("按键时间太短");K.onstop=()=>{const e=new Blob(ee,{type:"audio/mpeg"}),t=new FormData;t.append("file",e,"audio.mp3"),fetch("http://localhost:8080/api/files/upload",{method:"POST",body:t}).then((e=>e.json())).then((e=>{if(console.log(e),!e.data)return console.error("上传失败，服务器没有返回有效的URL"),void this.$notify.error("上传失败，服务器没有返回有效的URL");let t=this.getMessage("audio");t.content=e.data,t.type="audio",q.send(JSON.stringify(t)),this.recordingStatus="idle"})).catch((e=>{console.error("上传失败",e),this.$notify.error("上传失败")}))}}},handleKeyDown(e){" "===e.key?(e.preventDefault(),"ready"===this.recordingStatus&&this.startRecording()):"Escape"===e.key&&this.cancelRecording()},handleKeyUp(e){" "===e.key&&"recording"===this.recordingStatus&&this.stopRecording()}}},se=te,ae=(0,r.A)(se,Z,V,!1,null,"4d2d62d6",null),ie=ae.exports,oe=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"main-body-content"},[t("div",{staticStyle:{display:"flex","align-items":"flex-start",height:"80vh"}},[t("div",{staticStyle:{width:"200px",border:"1px solid #ddd","border-radius":"10px",height:"100%"}},[t("div",{staticStyle:{padding:"10px","border-bottom":"1px solid #ddd",color:"#000","background-color":"#eee","border-radius":"10px 10px 0 0"}},[e._v(" 在线用户("+e._s(e.users.length)+") ")]),t("div",{staticClass:"user-list-box",staticStyle:{"border-radius":"0 0 10px 10px"}},e._l(e.users,(function(s,a){return t("div",{key:a,staticClass:"user-list-item"},[t("img",{staticStyle:{width:"30px",height:"30px","border-radius":"50%"},attrs:{src:s.avatar}}),t("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(s.name))])])})),0)]),t("div",{staticStyle:{flex:"1",border:"1px solid #ddd","border-radius":"10px","background-color":"#f1f1f1",margin:"0 10px",height:"100%",display:"flex","flex-direction":"column"}},[t("div",{staticStyle:{padding:"20px 0","text-align":"center","border-bottom":"1px solid #ddd",color:"#000","background-color":"#eee",height:"60px","border-radius":"10px 10px 0 0"}},[e._v(" 聊天室 ")]),t("div",{staticClass:"im-message-box"},e._l(e.messages,(function(s){return t("div",{key:s.id},[s.name===e.user.name?t("div",{staticStyle:{display:"flex","flex-direction":"row-reverse","align-items":"flex-start"}},[t("img",{staticStyle:{width:"40px",height:"40px","border-radius":"50%","margin-left":"10px"},attrs:{src:s.avatar,alt:""}}),"text"===s.type?t("div",{staticClass:"im-message im-message-right",domProps:{innerHTML:e._s(s.content)}}):e._e(),"img"===s.type?t("div",{staticClass:"im-message",staticStyle:{padding:"0"},on:{click:function(t){return e.dakai(s)}}},["http://localhost:8080/api/files/cai.png"==s.content?t("el-image",{staticStyle:{width:"200px"},attrs:{src:s.content,alt:"","preview-src-list":[e.url]},on:{load:e.scrollToBottom}}):t("el-image",{staticStyle:{width:"100px"},attrs:{src:s.content,alt:"","preview-src-list":[s.content]},on:{load:e.scrollToBottom}})],1):e._e(),"video"===s.type?t("div",{staticClass:"im-message"},[t("video",{staticStyle:{width:"100%"},attrs:{controls:"",src:s.content},on:{loadeddata:e.scrollToBottom}})]):e._e(),"file"===s.type?t("div",{staticClass:"im-message im-message-download",on:{click:function(t){return e.download(s.content)}}},[t("div",[t("i",{staticClass:"el-icon-folder-opened"}),t("span",[e._v(e._s(s.content.substring(s.content.indexOf("-")+1)))])])]):e._e()]):t("div",{staticStyle:{display:"flex","align-items":"flex-start"}},[t("img",{staticStyle:{width:"40px",height:"40px","border-radius":"50%","margin-right":"10px"},attrs:{src:s.avatar,alt:""}}),t("div",{staticStyle:{width:"100%"}},[t("div",{staticStyle:{color:"#888","font-size":"12px",width:"50%"}},[e._v(" "+e._s(s.name)+" ")]),"text"===s.type?t("div",{staticClass:"im-message im-message-left",domProps:{innerHTML:e._s(s.content)}}):e._e(),"img"===s.type?t("div",{staticClass:"im-message",staticStyle:{padding:"0"},on:{click:function(t){return e.dakai(s)}}},["http://localhost:8080/api/files/cai.png"==s.content?t("el-image",{staticStyle:{width:"200px"},attrs:{src:s.content,alt:"","preview-src-list":[e.url]},on:{load:e.scrollToBottom}}):t("el-image",{staticStyle:{width:"100px"},attrs:{src:s.content,alt:"","preview-src-list":[s.content]},on:{load:e.scrollToBottom}})],1):e._e(),"video"===s.type?t("div",{staticClass:"im-message"},[t("video",{staticStyle:{width:"100%"},attrs:{controls:"",src:s.content},on:{loadeddata:e.scrollToBottom}})]):e._e(),"file"===s.type?t("div",{staticClass:"im-message im-message-download",on:{click:function(t){return e.download(s.content)}}},[t("div",[t("i",{staticClass:"el-icon-folder-opened"}),t("span",[e._v(e._s(s.content.substring(s.content.indexOf("-")+1)))])])]):e._e()])])])})),0),t("div",{staticStyle:{padding:"10px 5px","border-top":"1px solid #ddd",display:"flex","align-items":"center",width:"100%"}},[t("el-popover",{attrs:{placement:"top",width:"300",trigger:"click"}},[t("div",{staticClass:"emoji-box"},e._l(e.emojis,(function(s,a){return t("span",{key:a,staticStyle:{"margin-right":"5px","font-size":"20px",cursor:"pointer"},domProps:{innerHTML:e._s(s)},on:{click:function(t){return e.clickEmoji(s)}}})})),0),t("i",{staticClass:"fa fa-smile-o",staticStyle:{"font-size":"22px",color:"#666"},attrs:{slot:"reference"},slot:"reference"})]),t("div",{staticStyle:{"margin-left":"5px"}},[t("el-upload",{attrs:{action:"http://localhost:8080/api/files/upload","show-file-list":!1,"on-success":e.handleFile}},[t("i",{staticClass:"fa fa-folder-open-o",staticStyle:{"font-size":"20px",color:"#666"}})])],1),t("div",{staticStyle:{flex:"1","background-color":"#fff",margin:"0 5px",padding:"10px",border:"1px solid #ddd","border-radius":"2px",outline:"none","font-size":"14px"},attrs:{id:"im-content",contenteditable:""}}),t("el-button",{staticStyle:{border:"none"},attrs:{type:"primary"},on:{click:e.send}},[e._v("发送")])],1)])])]),t("el-dialog",{attrs:{title:"红包信息",visible:e.hongbaoopen,width:"50%","append-to-body":""},on:{"update:visible":function(t){e.hongbaoopen=t}}},[t("el-form",{ref:"form",attrs:{"label-width":"90px"}},[t("el-form-item",{attrs:{label:"红包金额",prop:"money"}},[t("el-input",{attrs:{oninput:"value=value.replace(/[^0-9.]/g,'')",placeholder:"请输入红包金额"},model:{value:e.money,callback:function(t){e.money=t},expression:"money"}})],1),t("el-form-item",{attrs:{label:"领取人数",prop:"shuliang"}},[t("el-input",{attrs:{oninput:"value=value.replace(/[^\\d]/g,'')",placeholder:"请输入领取人数"},model:{value:e.shuliang,callback:function(t){e.shuliang=t},expression:"shuliang"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确 定")]),t("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)],1)],1)},re=[],ne=(s(4979),"data:image/png;base64,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");let le;var ce={data(){return{jiluopen:!1,money:"",shuliang:"",hongbaoopen:!1,url:"http://localhost:8080/api/files/kai.png",hongbao:ne,user:{},permission:[],emojis:[],messages:[],users:[]}},mounted(){this.emojis=j.split(","),this.user=JSON.parse(localStorage.getItem("user")||"{}");let e=window.btoa(encodeURI(this.user.name)),t=window.btoa(encodeURI(this.user.avatar));le=new WebSocket(`ws://localhost:8080/imserver/${e}/${t}`),le.onopen=()=>{console.log("websocket open")},le.onclose=()=>{console.log("websocket close")},le.onmessage=e=>{if(e.data){let t=JSON.parse(e.data);t.name&&t.content&&(this.messages.push(t),this.scrollToBottom()),t.users&&t.users.length&&(this.users=t.users,console.log("onmessage",this.users))}},this.load()},beforeDestroy(){le&&le.close()},methods:{submitForm(){let e=JSON.parse(localStorage.getItem("user")).zongmoney,t=JSON.parse(localStorage.getItem("user"));if(console.log("this.money",this.money),console.log("this.shuliang",this.shuliang),console.log("xxx",e),this.money&&this.shuliang){if(1*this.money>1*e)this.$message.error("账户余额不够");else if(le){let e={name:this.user.name,content:"http://localhost:8080/api/files/cai.png",avatar:this.user.avatar,type:"img",money:this.money,shuliang:this.shuliang};le.send(JSON.stringify(e)),this.$message.success("红包发送成功！"),t.zongmoney=1*t.zongmoney-1*this.money,g.post("/user",t).then((e=>{"0"===e.code?localStorage.setItem("user",JSON.stringify(t)):this.$message.error(e.msg)}));const s=new Date,a=s.getFullYear()+"-"+(s.getMonth()+1).toString().padStart(2,"0")+"-"+s.getDate().toString().padStart(2,"0");g.post("/logs",{name:this.user.name,content:this.money,avatar:this.user.avatar,type:0,time:a}).then((e=>{"0"===e.code||this.$message.error(e.msg)})),this.hongbaoopen=!1}}else this.$message.error("请填写完整红包信息")},cancel(){this.hongbaoopen=!1},getRandomNumber(e,t){var s;do{var a=Math.random(),i=a*(t-e)+e;s=parseFloat(i.toFixed(2))}while(s==e||s==t);return s},dakai(e){console.log("e",e),"http://localhost:8080/api/files/cai.png"==e.content&&g.get("/logs").then((t=>{if(console.log("logslogs",t),"0"===t.code){let a=[],i=0,o=0;if(t.data.forEach((t=>{t.type==e.id&&(a.push(t),i=1*i+1*t.content,t.name==JSON.parse(localStorage.getItem("user")).name&&(o=1))})),1==o)this.$message.error("您已经领过该红包！");else if(a.length<e.shuliang){const t=new Date,o=t.getFullYear()+"-"+(t.getMonth()+1).toString().padStart(2,"0")+"-"+t.getDate().toString().padStart(2,"0");if(a.length==1*e.shuliang-1)g.post("/logs",{name:this.user.name,content:1*e.money-1*i,avatar:this.user.avatar,type:e.id,time:o}).then((t=>{if(console.log("领红包",t),"0"===t.code){let s=JSON.parse(localStorage.getItem("user"));s.zongmoney=1*s.zongmoney+1*e.money-1*i,g.post("/user",s).then((e=>{"0"===e.code?(localStorage.setItem("user",JSON.stringify(s)),this.$message.success("红包领取成功!金额："+t.data.content+"元")):this.$message.error(e.msg)}))}else this.$message.error(t.msg)}));else{var s=this.getRandomNumber(0,1*e.money-1*i);console.log(s),g.post("/logs",{name:this.user.name,content:s,avatar:this.user.avatar,type:e.id,time:o}).then((e=>{if(console.log("领红包",e),"0"===e.code){let t=JSON.parse(localStorage.getItem("user"));t.zongmoney=1*t.zongmoney+1*s,g.post("/user",t).then((s=>{"0"===s.code?(localStorage.setItem("user",JSON.stringify(t)),this.$message.success("红包领取成功!金额："+e.data.content+"元")):this.$message.error(s.msg)}))}else this.$message.error(e.msg)}))}}else this.$message.error("红包已领完")}else this.$message.error(t.msg)}))},facai(){this.money="",this.shuliang="",this.hongbaoopen=!0},download(e){window.open(e)},handleFile(e){if(le){let t={name:this.user.name,content:e.data,avatar:this.user.avatar},s=e.data.substring(e.data.lastIndexOf(".")+1);["png","jpg","jpeg","gif","bmp","tiff","svg","webp"].includes(s)?t.type="img":["mp4","avi","mkv","mov","wmv","flv"].includes(s)?t.type="video":t.type="file",le.send(JSON.stringify(t))}},load(){g.get("/imGroup").then((e=>{"0"===e.code?(this.messages=e.data,this.scrollToBottom(),this.$message.success("欢迎进入群组聊天室")):this.$message.error(e.msg)}))},send(){let e=document.getElementById("im-content");const t=e.innerHTML;if(t){if(le){let e={name:this.user.name,content:t,avatar:this.user.avatar,type:"text"};le.send(JSON.stringify(e))}e.innerHTML=""}else this.$notify.error("请输入聊天内容")},clickEmoji(e){document.getElementById("im-content").innerHTML+=e},scrollToBottom(){this.$nextTick((()=>{let e=document.getElementsByClassName("im-message-box")[0];e.scrollTop=e.scrollHeight}))},don(){(0,p.A)({url:"http://localhost:8080/api/imGroup/don",method:"GET",responseType:"blob"}).then((e=>{const t=new Blob([e.data],{type:"application/octet-stream"}),s=document.createElement("a");s.href=URL.createObjectURL(t),s.download="群组的聊天记录.xls",s.click()})).catch((e=>{console.error("下载文件时发生错误:",e)}))}}},de=ce,me=(0,r.A)(de,oe,re,!1,null,"b91e0646",null),ue=me.exports,pe=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{width:"50%","margin-top":"20px"}},[t("el-form",{attrs:{model:e.user}},[t("el-form-item",{attrs:{label:"头像","label-width":"15%"}},[t("el-upload",{ref:"tx",attrs:{action:"http://localhost:8080/api/files/upload","on-success":e.txSuccessUpload}},[t("el-button",{attrs:{size:"small",type:"success"}},[e._v("点击上传")])],1)],1),t("el-form-item",{attrs:{label:"姓名","label-width":"15%"}},[t("el-input",{staticStyle:{width:"90%"},attrs:{disabled:"",autocomplete:"off"},model:{value:e.user.name,callback:function(t){e.$set(e.user,"name",t)},expression:"user.name"}})],1),t("el-form-item",{attrs:{label:"性别","label-width":"15%"}},[t("el-radio",{attrs:{label:"男"},model:{value:e.user.sex,callback:function(t){e.$set(e.user,"sex",t)},expression:"user.sex"}},[e._v("男")]),t("el-radio",{attrs:{label:"女"},model:{value:e.user.sex,callback:function(t){e.$set(e.user,"sex",t)},expression:"user.sex"}},[e._v("女")])],1),t("el-form-item",{attrs:{label:"年龄","label-width":"15%"}},[t("el-input",{staticStyle:{width:"90%"},attrs:{autocomplete:"off"},model:{value:e.user.age,callback:function(t){e.$set(e.user,"age",t)},expression:"user.age"}})],1),t("el-form-item",{attrs:{label:"电话","label-width":"15%"}},[t("el-input",{staticStyle:{width:"90%"},attrs:{autocomplete:"off"},model:{value:e.user.phone,callback:function(t){e.$set(e.user,"phone",t)},expression:"user.phone"}})],1)],1),t("div",{staticStyle:{"text-align":"center"}},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submit()}}},[e._v("保 存")])],1)],1)},he=[],ge={data(){return{user:localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")):{}}},created(){},methods:{submit(){g.post("/user",this.user).then((e=>{"0"===e.code?(this.$message.success("操作成功"),this.$bus.$emit("updateAvatar",this.user)):this.$message.error(e.msg)}))},txSuccessUpload(e){this.user.avatar=e.data}}},fe=ge,ve=(0,r.A)(fe,pe,he,!1,null,null,null),ye=ve.exports,be=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticStyle:{"margin-bottom":"15px"}},[t("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入公告标题"},model:{value:e.params.name,callback:function(t){e.$set(e.params,"name",t)},expression:"params.name"}}),t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"warning"},on:{click:function(t){return e.findBySearch()}}},[e._v("查询")]),t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"warning"},on:{click:function(t){return e.reset()}}},[e._v("清空")]),t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:function(t){return e.add()}}},[e._v("新增")])],1),t("div",[t("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:e.tableData}},[t("el-table-column",{attrs:{align:"center",prop:"name",label:"公告标题"}}),t("el-table-column",{attrs:{align:"center",prop:"content",label:"公告内容"}}),t("el-table-column",{attrs:{align:"center",prop:"time",label:"更新时间"}}),t("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.edit(s.row)}}},[e._v("编辑")]),t("el-popconfirm",{attrs:{title:"确定删除吗？"},on:{confirm:function(t){return e.del(s.row.id)}}},[t("el-button",{staticStyle:{"margin-left":"5px"},attrs:{slot:"reference",type:"danger"},slot:"reference"},[e._v("删除")])],1)]}}])})],1)],1),t("div",{staticStyle:{"margin-top":"10px"}},[t("el-pagination",{attrs:{"current-page":e.params.pageNum,"page-sizes":[5,10,15,20],"page-size":e.params.pageSize,layout:"total, sizes, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("div",[t("el-dialog",{attrs:{title:"请填写信息",visible:e.dialogFormVisible,width:"30%"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[t("el-form",{attrs:{model:e.form}},[t("el-form-item",{attrs:{label:"公告标题","label-width":"15%"}},[t("el-input",{staticStyle:{width:"90%"},attrs:{autocomplete:"off"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),t("el-form-item",{attrs:{label:"公告内容","label-width":"15%"}},[t("el-input",{staticStyle:{width:"90%"},attrs:{type:"textarea",autocomplete:"off"},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submit()}}},[e._v("确 定")])],1)],1)],1)])},Se=[],xe={data(){return{params:{name:"",pageNum:1,pageSize:5},tableData:[],total:0,dialogFormVisible:!1,form:{}}},created(){this.findBySearch()},methods:{findBySearch(){g.get("/notice/search",{params:this.params}).then((e=>{"0"===e.code?(this.tableData=e.data.list,this.total=e.data.total):this.$message({message:e.msg,type:"success"})}))},add(){this.form={},this.dialogFormVisible=!0},edit(e){this.form=e,this.dialogFormVisible=!0},reset(){this.params={pageNum:1,pageSize:5,name:"",phone:""},this.findBySearch()},handleSizeChange(e){this.params.pageSize=e,this.findBySearch()},handleCurrentChange(e){this.params.pageNum=e,this.findBySearch()},submit(){g.post("/notice",this.form).then((e=>{"0"===e.code?(this.$message({message:"操作成功",type:"success"}),this.dialogFormVisible=!1,this.findBySearch()):this.$message({message:e.msg,type:"error"})}))},del(e){g.delete("/notice/"+e).then((e=>{"0"===e.code?(this.$message({message:"删除成功",type:"success"}),this.findBySearch()):this.$message({message:e.msg,type:"success"})}))}}},we=xe,Ae=(0,r.A)(we,be,Se,!1,null,null,null),ke=Ae.exports,Ce=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{width:"50%","margin-top":"20px"}},[t("el-form",{attrs:{model:e.user}},[t("el-form-item",{attrs:{label:"原密码","label-width":"15%"}},[t("el-input",{staticStyle:{width:"90%"},attrs:{"show-password":"",autocomplete:"off"},model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}})],1),t("el-form-item",{attrs:{label:"新密码","label-width":"15%"}},[t("el-input",{staticStyle:{width:"90%"},attrs:{"show-password":"",autocomplete:"off"},model:{value:e.user.newPassword,callback:function(t){e.$set(e.user,"newPassword",t)},expression:"user.newPassword"}})],1),t("el-form-item",{attrs:{label:"确认密码","label-width":"15%"}},[t("el-input",{staticStyle:{width:"90%"},attrs:{"show-password":"",autocomplete:"off"},model:{value:e.user.new2Password,callback:function(t){e.$set(e.user,"new2Password",t)},expression:"user.new2Password"}})],1)],1),t("div",{staticStyle:{"text-align":"center"}},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submit()}}},[e._v("提 交")])],1)],1)},Be=[],Ne={data(){return{user:localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")):{}}},created(){},methods:{submit(){this.user.password?this.user.newPassword?this.user.new2Password?this.user.newPassword===this.user.new2Password?g.post("/user/password",this.user).then((e=>{"0"===e.code?(this.$message.success("修改成功"),localStorage.removeItem("user"),this.$router.push("/login")):this.$message.error(e.msg)})):this.$message.warning("两次输入的密码不一致"):this.$message.warning("请确认新密码"):this.$message.warning("请输入新密码"):this.$message.warning("请输入原密码")},txSuccessUpload(e){this.user.avatar=e.data}}},Ie=Ne,ze=(0,r.A)(Ie,Ce,Be,!1,null,null,null),Ee=ze.exports,Qe=function(){var e=this,t=e._self._c;return t("div",[t("div",[t("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:e.tableData}},[t("el-table-column",{attrs:{align:"center",label:"头像"},scopedSlots:e._u([{key:"default",fn:function(e){return[t("el-image",{staticStyle:{width:"50px",height:"50px","border-radius":"50%"},attrs:{src:e.row.userAvatar,"preview-src-list":[e.row.userAvatar]}})]}}])}),t("el-table-column",{attrs:{align:"center",prop:"userName",label:"姓名"}}),t("el-table-column",{attrs:{align:"center",prop:"nr",label:"内容"}}),t("el-table-column",{attrs:{align:"center",prop:"zt",label:"状态"},scopedSlots:e._u([{key:"default",fn:function({row:s}){return["0"===s.zt?t("span",[e._v("申请中")]):e._e(),"1"===s.zt?t("span",[e._v("已通过")]):e._e(),"2"===s.zt?t("span",[e._v("已拒绝")]):e._e()]}}])}),t("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(s){return["0"===s.row.zt?t("el-button",{attrs:{type:"success",plain:""},on:{click:function(t){return e.handleUpdateZt(s.row,"1")}}},[e._v("通过")]):e._e(),"0"===s.row.zt?t("el-button",{attrs:{type:"danger",plain:""},on:{click:function(t){return e.handleUpdateZt(s.row,"2")}}},[e._v("拒绝")]):e._e(),"2"===s.row.zt?t("el-popconfirm",{attrs:{title:"确定删除吗？"},on:{confirm:function(t){return e.del(s.row.id)}}},[t("el-button",{staticStyle:{"margin-left":"5px"},attrs:{slot:"reference",type:"danger"},slot:"reference"},[e._v("删除")])],1):e._e()]}}])})],1)],1),t("div",{staticStyle:{"margin-top":"10px"}},[t("el-pagination",{attrs:{"current-page":e.params.pageNum,"page-sizes":[5,10,15,20],"page-size":e.params.pageSize,layout:"total, sizes, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])},Ue=[],Oe={data(){return{params:{pageNum:1,pageSize:5},user:localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")):{},tableData:[],total:0,dialogFormVisible:!1,form:{}}},created(){this.findBySearch()},methods:{findBySearch(){g.get("/hy/hyyzlist",{params:this.params}).then((e=>{"0"===e.code?(this.tableData=e.data.list,this.total=e.data.total):this.$message({message:e.msg,type:"success"})}))},handleSizeChange(e){this.params.pageSize=e,this.findBySearch()},handleCurrentChange(e){this.params.pageNum=e,this.findBySearch()},handleUpdateZt(e,t){let s={...e};s.zt=t,this.$confirm("是否确定","提示").then((({value:e})=>{g.post("/hy/update",s).then((e=>{"0"===e.code?this.$message.success("提交成功!"):this.$message.error(e.msg),this.findBySearch()}))})).catch((()=>{}))},del(e){g.delete("/hy/"+e).then((e=>{"0"===e.code?(this.$message({message:"删除成功",type:"success"}),this.findBySearch()):this.$message({message:e.msg,type:"success"})}))}}},Me=Oe,De=(0,r.A)(Me,Qe,Ue,!1,null,null,null),Re=De.exports,Le=function(){var e=this,t=e._self._c;return t("div",[t("div",[t("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:e.tableData}},[t("el-table-column",{attrs:{align:"center",label:"头像"},scopedSlots:e._u([{key:"default",fn:function(e){return[t("el-image",{staticStyle:{width:"50px",height:"50px","border-radius":"50%"},attrs:{src:e.row.userAvatar,"preview-src-list":[e.row.userAvatar]}})]}}])}),t("el-table-column",{attrs:{align:"center",prop:"userName",label:"姓名"}}),t("el-table-column",{attrs:{align:"center",prop:"hyGroupName",label:"分组"}}),t("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-popconfirm",{attrs:{title:"确定删除吗？"},on:{confirm:function(t){return e.del(s.row.id)}}},[t("el-button",{staticStyle:{"margin-left":"5px"},attrs:{slot:"reference",type:"danger"},slot:"reference"},[e._v("删除")])],1),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.openMoveGroupDialog(s.row)}}},[e._v("移动")])]}}])})],1)],1),t("div",{staticStyle:{"margin-top":"10px"}},[t("el-pagination",{attrs:{"current-page":e.params.pageNum,"page-sizes":[5,10,15,20],"page-size":e.params.pageSize,layout:"total, sizes, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("el-dialog",{attrs:{visible:e.moveGroupDialogVisible,title:"修改分组"},on:{"update:visible":function(t){e.moveGroupDialogVisible=t}}},[t("el-form",{attrs:{model:e.currentFriend}},[t("el-form-item",{attrs:{label:"姓名"}},[t("el-input",{attrs:{disabled:""},model:{value:e.currentFriend.userName,callback:function(t){e.$set(e.currentFriend,"userName",t)},expression:"currentFriend.userName"}})],1),t("el-form-item",{attrs:{label:"新分组"}},[t("el-input",{model:{value:e.newGroupName,callback:function(t){e.newGroupName=t},expression:"newGroupName"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.moveGroupDialogVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.updateGroup}},[e._v("确认")])],1)],1)],1)},_e=[],Fe={data(){return{params:{pageNum:1,pageSize:5},user:localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")):{},tableData:[],total:0,dialogFormVisible:!1,form:{},moveGroupDialogVisible:!1,currentFriend:{},newGroupName:""}},created(){this.findBySearch()},methods:{findBySearch(){g.get("/hy/list",{params:this.params}).then((e=>{"0"===e.code?(this.tableData=e.data.list,this.total=e.data.total):this.$message({message:e.msg,type:"success"})}))},handleSizeChange(e){this.params.pageSize=e,this.findBySearch()},handleCurrentChange(e){this.params.pageNum=e,this.findBySearch()},del(e){g.delete("/hy/"+e).then((e=>{"0"===e.code?(this.$message({message:"删除成功",type:"success"}),this.findBySearch()):this.$message({message:e.msg,type:"success"})}))},openMoveGroupDialog(e){this.currentFriend={...e},this.newGroupName=e.hyGroupName,this.moveGroupDialogVisible=!0},updateGroup(){const e={...this.currentFriend,hyGroupName:this.newGroupName};g.post("/hy/update",e).then((e=>{if("0"===e.code){this.$message({message:"分组更新成功",type:"success"});const e=this.tableData.findIndex((e=>e.id===this.currentFriend.id));-1!==e&&(this.tableData[e].hyGroupName=this.newGroupName),this.moveGroupDialogVisible=!1}else this.$message({message:e.msg,type:"error"})}))}}},Te=Fe,Pe=(0,r.A)(Te,Le,_e,!1,null,null,null),He=Pe.exports;a["default"].use(d.Ay);const Ge=[{path:"/login",component:C},{path:"/register",component:G},{path:"/",component:L,children:[{path:"",component:b},{path:"user",component:Q},{path:"hyyz",component:Re},{path:"hy",component:He},{path:"notice",component:ke},{path:"imSingle",component:ie},{path:"imGroup",component:ue},{path:"person",component:ye},{path:"password",component:Ee}]}],Ze=new d.Ay({mode:"history",base:"/",routes:Ge}),Ve=d.Ay.prototype.push;d.Ay.prototype.push=function(e){return Ve.call(this,e).catch((e=>e))},Ze.beforeEach(((e,t,s)=>{const a=localStorage.getItem("user");if(!a&&"/login"!==e.path&&"/register"!==e.path)return s("/login");s()}));var Je=Ze,je=s(9143),qe=s.n(je);a["default"].config.productionTip=!1,a["default"].use(qe(),{size:"small"}),a["default"].prototype.$bus=new a["default"],new a["default"]({router:Je,render:e=>e(c)}).$mount("#app")},3153:function(e,t,s){e.exports=s.p+"img/logo.7b304b62.png"}},t={};function s(a){var i=t[a];if(void 0!==i)return i.exports;var o=t[a]={id:a,loaded:!1,exports:{}};return e[a].call(o.exports,o,o.exports,s),o.loaded=!0,o.exports}s.m=e,function(){s.amdO={}}(),function(){var e=[];s.O=function(t,a,i,o){if(!a){var r=1/0;for(d=0;d<e.length;d++){a=e[d][0],i=e[d][1],o=e[d][2];for(var n=!0,l=0;l<a.length;l++)(!1&o||r>=o)&&Object.keys(s.O).every((function(e){return s.O[e](a[l])}))?a.splice(l--,1):(n=!1,o<r&&(r=o));if(n){e.splice(d--,1);var c=i();void 0!==c&&(t=c)}}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[a,i,o]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){s.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){s.p="/"}(),function(){var e={524:0};s.O.j=function(t){return 0===e[t]};var t=function(t,a){var i,o,r=a[0],n=a[1],l=a[2],c=0;if(r.some((function(t){return 0!==e[t]}))){for(i in n)s.o(n,i)&&(s.m[i]=n[i]);if(l)var d=l(s)}for(t&&t(a);c<r.length;c++)o=r[c],s.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return s.O(d)},a=self["webpackChunkvue"]=self["webpackChunkvue"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=s.O(void 0,[504],(function(){return s(471)}));a=s.O(a)})();
//# sourceMappingURL=app.0dafcc94.js.map